# セッション16：確率 (8th Grade)

**対象:** Rust/Goプログラマのための数学超速習
**テーマ:** 場合の数、確率の定義、独立試行

---

## Phase 1: Foundational Check (基礎の確認) - 10問

**「ランダムネス」**: 決定論的（Deterministic）なプログラムとは異なり、確率的（Probabilistic）な現象を扱います。

### Q1. 確率の定義
ある試行において、起こりうるすべての場合の数が `N` 通りあり、そのどれが起こることも同様に確からしいとき、事象Aの起こる場合の数が `a` 通りであるならば、事象Aの確率 `P(A)` はどう表されますか。

<details>
<summary>解答と解説</summary>

**解答:** `P(A) = a / N`

**解説:**
`0 ≦ P(A) ≦ 1`。
「同様に確からしい（Equally Likely）」という前提が重要。

> **Programming Link:**
> *   **Uniform Distribution:** 一様分布。`rand.Intn(N)` が 0〜N-1 を等確率で返すことと同じです。
</details>

### Q2. 余事象の確率
事象Aが起こらない確率（余事象の確率）は、どう表されますか。

<details>
<summary>解答と解説</summary>

**解答:** `1 - P(A)`

**解説:**
全事象の確率は1。
`P(not A) = 1 - P(A)`。

> **Programming Link:**
> *   **Boolean NOT:** `!flag` の確率的な表現です。
</details>

### Q3. 樹形図
場合の数を漏れなく重複なく数え上げるために使う、枝分かれした図を何といいますか。

<details>
<summary>解答と解説</summary>

**解答:** 樹形図 (Tree Diagram)

**解説:**
全探索（Brute Force）の可視化。

> **Programming Link:**
> *   **Decision Tree:** 決定木や探索木と同じ構造です。
</details>

### Q4. サイコロの確率
1つのサイコロを投げるとき、奇数の目が出る確率は？

<details>
<summary>解答と解説</summary>

**解答:** `1/2`

**解説:**
全事象: 6通り。奇数: 1, 3, 5 の3通り。
`3/6 = 1/2`。
</details>

### Q5. コインの確率
2枚のコインを同時に投げるとき、2枚とも表になる確率は？

<details>
<summary>解答と解説</summary>

**解答:** `1/4`

**解説:**
(表, 表), (表, 裏), (裏, 表), (裏, 裏) の4通り。
求めるのは1通り。
</details>

### Q6. 積の法則（独立試行）
事象Aと事象Bが互いに影響しない（独立である）とき、AとBがともに起こる確率は？

<details>
<summary>解答と解説</summary>

**解答:** `P(A) × P(B)`

**解説:**
サイコロを2回振る場合など。
</details>

### Q7. 和の法則（排反事象）
事象Aと事象Bが同時には起こらない（排反である）とき、AまたはBが起こる確率は？

<details>
<summary>解答と解説</summary>

**解答:** `P(A) + P(B)`

**解説:**
偶数が出るか、5が出るか、など。
</details>

### Q8. 順列 (Permutation)
異なるn個のものからr個を選んで一列に並べる並べ方の総数を表す記号は？

<details>
<summary>解答と解説</summary>

**解答:** `nPr`

**解説:**
`n * (n-1) * ... * (n-r+1)`。
</details>

### Q9. 組み合わせ (Combination)
異なるn個のものから順序を考えずにr個を選ぶ選び方の総数を表す記号は？

<details>
<summary>解答と解説</summary>

**解答:** `nCr`

**解説:**
`nPr / r!`。
中学数学では記号は習わないが、概念は学ぶ。
</details>

### Q10. 同様に確からしい
「コインを投げるとき、立つ場合もあるから表が出る確率は1/2ではない」という主張は数学的に正しいですか。

<details>
<summary>解答と解説</summary>

**解答:** 数学モデルとしては正しくない（通常は無視する）。

**解説:**
数学の問題では理想的なコイン（厚み0）を想定する。「同様に確からしい」という仮定（モデル）が成立するかどうかの問題。
</details>

---

## Phase 2: Applied Mastery (応用と実践) - 10問

**「モンテカルロ法」**: 確率的なシミュレーションによって解を求める手法の基礎です。

### Q11. 2つのサイコロの和
大小2つのサイコロを同時に投げるとき、目の和が7になる確率は？

<details>
<summary>解答と解説</summary>

**解答:** `1/6`

**Tips:**
全事象: `6 × 6 = 36`通り。
和が7: (1,6), (2,5), (3,4), (4,3), (5,2), (6,1) の6通り。
`6/36 = 1/6`。
</details>

### Q12. 少なくとも1つ
3枚のコインを投げるとき、少なくとも1枚は表が出る確率は？

<details>
<summary>解答と解説</summary>

**解答:** `7/8`

**Tips:**
余事象「すべて裏」を引く。
すべて裏は (裏, 裏, 裏) の1通り。
`1 - 1/8 = 7/8`。
</details>

### Q13. くじ引き（非復元抽出）
当たり3本、はずれ7本のくじから、Aさんが1本引き、戻さずにBさんが1本引くとき、Bさんが当たる確率は？

<details>
<summary>解答と解説</summary>

**解答:** `3/10`

**Tips:**
くじ引きは引く順番に関係なく確率は等しい（対称性）。
計算:
A当たりB当たり: `3/10 × 2/9 = 6/90`
AはずれB当たり: `7/10 × 3/9 = 21/90`
和: `27/90 = 3/10`。
</details>

### Q14. 玉の取り出し（組み合わせ）
赤玉3個、白玉2個が入った袋から、同時に2個取り出すとき、2個とも赤玉である確率は？

<details>
<summary>解答と解説</summary>

**解答:** `3/10`

**Tips:**
全事象: 5個から2個選ぶ `5C2 = 10`通り。
赤2個: 3個から2個選ぶ `3C2 = 3`通り。
`3/10`。
</details>

### Q15. 並べ替え（順列）
A, B, C, D, E の5人が一列に並ぶとき、AとBが隣り合う確率は？

<details>
<summary>解答と解説</summary>

**解答:** `2/5`

**Tips:**
全事象: `5! = 120`通り。
ABをセット（1人）とみなすと `4! = 24`通り。ABの並び順が2通りなので `24 × 2 = 48`通り。
`48/120 = 2/5`。
</details>

### Q16. 確率の積（復元抽出）
袋の中に赤玉4個、白玉6個が入っています。1個取り出して色を確認し、袋に戻してからもう一度取り出します。2回とも赤玉である確率は？

<details>
<summary>解答と解説</summary>

**解答:** `4/25`

**Tips:**
1回目赤: `4/10 = 2/5`。
2回目赤: `2/5`（戻すので確率は変わらない）。
`2/5 × 2/5 = 4/25`。

> **Programming Link:**
> *   **Stateless:** 状態を持たない（前の試行を記憶しない）独立した処理です。
</details>

### Q17. 期待値（予習）
100円でくじを引き、当たると500円もらえ、はずれると何ももらえません。当たる確率が1/10のとき、収支の期待値はいくらですか。

<details>
<summary>解答と解説</summary>

**解答:** `-50`円

**Tips:**
収入の期待値: `500 × 1/10 + 0 × 9/10 = 50`円。
コスト: 100円。
収支: `50 - 100 = -50`円。
ギャンブルは長期的には損をする（大数の法則）。
</details>

### Q18. 嘘つき問題（ベイズ推定の入り口）
ある検査薬は、病気の人を99%正しく陽性と判定しますが、健康な人も1%の確率で誤って陽性と判定してしまいます。
人口の0.1%がかかる病気について、この検査で陽性が出たとき、本当に病気である確率は高いですか？

<details>
<summary>解答と解説</summary>

**解答:** 意外と低い（約9%）

**Tips:**
直感に反する確率（Base Rate Fallacy）。
10000人中、病人は10人。陽性者は `10 × 0.99 ≈ 10`人。
健康な人は9990人。誤陽性者は `9990 × 0.01 ≈ 100`人。
陽性者合計110人のうち、本物は10人だけ。
`10 / 110 ≈ 0.09`。
</details>

### Q19. ランダムウォーク
数直線上を、コインを投げて表なら+1、裏なら-1進みます。2回投げて原点に戻る確率は？

<details>
<summary>解答と解説</summary>

**解答:** `1/2`

**Tips:**
(表, 裏) か (裏, 表) の2通り。全事象4通り。
`2/4 = 1/2`。
</details>

### Q20. 鳩の巣原理
靴下が赤、青、黄の3色たくさんあります。目をつぶって取り出すとき、必ず同じ色のペアを作るには、最低何枚取り出す必要がありますか。

<details>
<summary>解答と解説</summary>

**解答:** 4枚

**Tips:**
3枚だと全部違う色かもしれない。4枚目はいずれかの色と必ず一致する。
`n` 種類あるとき `n+1` 個選べば衝突（Collision）が起きる。

> **Programming Link:**
> *   **Hash Collision:** ハッシュテーブルで衝突が避けられない原理です。
</details>
