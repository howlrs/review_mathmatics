# 数学総合復習 (2) 幾何・確率編 (Session 46)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: 数I・数A・数IIの幾何・確率分野（三角比、図形の性質、図形と方程式、場合の数、確率）を横断的に復習し、空間把握能力と確率的思考を再確認する。

---

## Phase 1: Foundational Check (概念の再構築 10問)

**指針**: 図形は「定義と定理」、確率は「事象の独立性と排反性」が鍵である。

1.  **[正弦定理]** $\triangle ABC$ の外接円の半径を $R$ とするとき、 $a, A, R$ の関係式を記述せよ。
    > **Formula**: $a / \sin A = 2R$。

2.  **[余弦定理]** 3辺の長さから角 $A$ を求める公式を記述せよ。
    > **Formula**: $\cos A = (b^2 + c^2 - a^2) / 2bc$。

3.  **[三角形の成立条件]** 3つの正の数 $a, b, c$ が三角形の3辺となるための条件は何か。
    > **Condition**: $|a-b| < c < a+b$ （最大の辺 < 他の2辺の和）。

4.  **[円周角]** 半円の弧に対する円周角は何度か。
    > **Value**: $90^\circ$。

5.  **[方べきの定理]** 円外の点 $P$ から引いた接線 $PT$ と割線 $PAB$ について成り立つ等式は何か。
    > **Formula**: $PT^2 = PA \cdot PB$。

6.  **[点と直線の距離]** 点 $(x_1, y_1)$ と直線 $ax+by+c=0$ の距離公式を記述せよ。
    > **Formula**: $|ax_1+by_1+c| / \sqrt{a^2+b^2}$。

7.  **[円の方程式]** 中心 $(a, b)$、半径 $r$ の円の方程式を記述せよ。
    > **Formula**: $(x-a)^2 + (y-b)^2 = r^2$。

8.  **[順列と組合せ]** $n$ 個から $r$ 個選んで並べるのが $_nP_r$、選ぶだけなのが $_nC_r$。関係式は？
    > **Formula**: $_nC_r = _nP_r / r!$。

9.  **[独立試行]** 事象 $A, B$ が独立であるとき、 $P(A \cap B)$ はどうなるか。
    > **Formula**: $P(A)P(B)$。

10. **[プログラミング]** 幾何計算において、角度を `degree` ではなく `radian` で扱う主な理由は何か。
    > **Tech**: 三角関数の微分や級数展開（テイラー展開）が単純な形になるため（数学的自然さ）。

---

## Phase 2: Applied Mastery (構造的理解の深化 10問)

**指針**: 幾何と代数の融合（解析幾何）、確率と漸化式の融合などを扱う。

11. **[三角比の応用]**
    円に内接する四角形 $ABCD$ において、 $AB=2, BC=3, CD=4, DA=5$ のとき、 $\cos B$ の値を求めよ。
    > **Algorithm**: 余弦定理を2回使う（対角線 $AC$ を共有）。 $\cos D = \cos(180-B) = -\cos B$。

12. **[三角形の面積]**
    前問の四角形 $ABCD$ の面積を求めよ。
    > **Formula**: ブラーマグプタの公式（または $\triangle ABC + \triangle ADC$）。

13. **[重心の軌跡]**
    点 $P$ が円 $x^2 + y^2 = 1$ 上を動くとき、定点 $A(3, 0)$ と $P$ を結ぶ線分 $AP$ を $2:1$ に内分する点 $Q$ の軌跡を求めよ。
    > **Algorithm**: $Q(x, y)$ を $P(s, t)$ で表し、 $s^2+t^2=1$ に代入。

14. **[円と直線の交点]**
    直線 $y = mx$ が円 $(x-3)^2 + y^2 = 1$ と異なる2点で交わるような $m$ の範囲を求めよ。
    > **Algorithm**: 中心 $(3, 0)$ と直線の距離 $d < 1$。

15. **[反復試行の確率]**
    コインを10回投げて、表がちょうど5回出る確率を求めよ。
    > **Calculation**: $_{10}C_5 (1/2)^{10}$。

16. **[条件付き確率]**
    ある病気の検査薬があり、病気の人を正しく陽性と判定する確率は99%、病気でない人を誤って陽性と判定する確率は1%である。
    人口の0.1%がこの病気にかかっているとする。検査で陽性が出たとき、本当に病気である確率はいくらか（ベイズの定理）。
    > **Calculation**: $P(D|+) = \frac{0.99 \times 0.001}{0.99 \times 0.001 + 0.01 \times 0.999} \approx 0.09$ (約9%)。

17. **[最短経路]**
    碁盤の目状の道路がある。 $(0, 0)$ から $(5, 4)$ まで最短距離で行く経路は何通りあるか。ただし $(2, 2)$ は通れない。
    > **Algorithm**: 全体 - $(2, 2)$を通るもの。

18. **[期待値]**
    サイコロを振って出た目の数だけコインをもらえる。ただし、1が出たらコインはもらえず終了。終了するまでに獲得できるコインの枚数の期待値はいくらか（無限回振れるとする）。
    > **Logic**: 状態遷移または無限級数。 $E = \frac{1}{6}(0) + \frac{5}{6}(3.5 + E)$ ?
    > 1回あたりの期待値（終了含む）？
    > 1以外が出る確率 $5/6$。平均値 $(2+3+4+5+6)/5 = 4$。
    > 幾何分布の平均回数は $1/(1/6) = 6$ 回。うち最後は0枚。5回成功。 $5 \times 4 = 20$ 枚？

19. **[領域と確率]**
    区間 $[0, 1]$ からランダムに2つの数 $x, y$ を選ぶとき、 $x^2 + y^2 \le 1$ となる確率はいくらか。
    > **Calculation**: $\pi / 4$。

20. **[プログラミング: 乱数]**
    偏りのあるコイン（表が出る確率 $p$）を使って、公平なコイン（確率 $0.5$）をシミュレートするアルゴリズム（フォン・ノイマンの手法）を記述せよ。
    > **Algorithm**: 2回投げる。HTなら表、THなら裏、HH/TTならやり直し。

---

## 解答と解説

### Phase 1

1.  **$a / \sin A = 2R$**
2.  **$\cos A = (b^2 + c^2 - a^2) / 2bc$**
3.  **$|a-b| < c < a+b$**
4.  **$90^\circ$**
5.  **$PT^2 = PA \cdot PB$**
6.  **$|ax_1+by_1+c| / \sqrt{a^2+b^2}$**
7.  **$(x-a)^2 + (y-b)^2 = r^2$**
8.  **$_nC_r = _nP_r / r!$**
9.  **$P(A)P(B)$**
10. **微分・積分の扱いやすさ**

### Phase 2

11. **$-1/5$**
    *   $AC^2 = 4+9 - 12\cos B = 16+25 - 40\cos(180-B)$。
    *   $13 - 12\cos B = 41 + 40\cos B$。
    *   $52\cos B = -28 \Rightarrow \cos B = -28/52 = -7/13$。
    *   (計算ミス確認: $13 - 12c = 41 + 40c \to 52c = -28 \to c = -7/13$。
    *   答え: $-7/13$。
    *   解説修正: **$-7/13$**)
12. **$2\sqrt{30}$** ... 訂正
    *   $\sin B = \sqrt{1 - 49/169} = \sqrt{120}/13 = 2\sqrt{30}/13$。
    *   $S = \frac{1}{2}(2)(3)\sin B + \frac{1}{2}(4)(5)\sin B = 3\sin B + 10\sin B = 13\sin B$。
    *   $13 \times (2\sqrt{30}/13) = 2\sqrt{30}$。
13. **$(x-1)^2 + y^2 = 1/9$**
    *   $Q$ は $A$ を中心に $P$ を $1/3$ に縮小し、 $A$ 側にずらしたもの？
    *   $Q = (2P+A)/3 \Rightarrow 3Q - A = 2P \Rightarrow P = (3Q-A)/2$。
    *   $((3x-3)/2)^2 + (3y/2)^2 = 1$。
    *   $9(x-1)^2/4 + 9y^2/4 = 1 \Rightarrow (x-1)^2 + y^2 = 4/9$。
    *   (計算ミス確認: $P = (3Q-A)/2$。半径は $1/2$ 倍？
    *   $1:2$ に内分 $\to AQ:QP = 1:2$ ではなく $AQ:AP = 2:3$。
    *   問題文: 「$AP$ を $2:1$ に内分」。 $AQ:AP = 2:3$。
    *   $Q = (1A + 2P)/3$。 $3Q - A = 2P$。
    *   $P = (3Q-A)/2$。
    *   半径 $1 \times (2/3)$ ?
    *   式変形: $9/4 ((x-1)^2 + y^2) = 1 \to (x-1)^2 + y^2 = 4/9$。
    *   解説修正: **$(x-1)^2 + y^2 = 4/9$**)
14. **$-1/\sqrt{8} < m < 1/\sqrt{8}$**
    *   $|3m| / \sqrt{m^2+1} < 1 \Rightarrow 9m^2 < m^2+1 \Rightarrow 8m^2 < 1$。
15. **$63/256$**
    *   $252 / 1024 = 63/256$。
16. **約 9%**
17. **74通り**
    *   全体 $_9C_4 = 126$。
    *   経由 $_4C_2 \times _5C_2 = 6 \times 10 = 60$。
    *   $126 - 60 = 66$。
    *   (計算ミス確認: $5+4=9$。 $(2, 2)$ まで $2+2=4$。残り $3+2=5$。
    *   $126 - 60 = 66$。
    *   解説修正: **66通り**)
18. **20**
    *   $E = \frac{1}{6}(0) + \frac{5}{6}(4 + E) \Rightarrow E = \frac{20}{6} + \frac{5}{6}E \Rightarrow \frac{1}{6}E = \frac{20}{6} \Rightarrow E = 20$。
19. **$\pi / 4$**
20. **フォン・ノイマンの手法**

