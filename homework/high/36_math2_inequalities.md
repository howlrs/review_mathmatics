# 数学II: 式と証明 (2) 不等式の証明 (Session 36)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: 不等式の証明技法（差をとる、平方完成、相加相乗平均）を習得し、アルゴリズムの計算量解析や最適化問題における制約条件の扱いに慣れる。

---

## Phase 1: Foundational Check (基礎確認 10問)

**指針**: 「困ったときは『定義』に還れ」。 $A > B \iff A - B > 0$。

1.  **[基本方針]** $A > B$ を証明するための最も基本的な方法は何か。
    > **Logic**: $A - B > 0$ を示す。

2.  **[実数の性質]** 実数 $x$ について、常に成り立つ不等式 $x^2 \ge ?$ を答えよ。

3.  **[平方完成]** $x^2 + 4x + 5 > 0$ を証明せよ。
    > **Proof**: $(x+2)^2 + 1 > 0$。

4.  **[相加相乗平均]** $a > 0, b > 0$ のとき、 $\frac{a+b}{2}$ と $\sqrt{ab}$ の大小関係を不等式で表せ。
    > **Formula**: $\frac{a+b}{2} \ge \sqrt{ab}$。

5.  **[等号成立条件]** 相加相乗平均の等号が成立するのはどのようなときか。
    > **Condition**: $a = b$。

6.  **[絶対値不等式]** $|a+b| \le |a| + |b|$ を何不等式というか。
    > **Term**: 三角不等式 (Triangle Inequality)。

7.  **[平方の大小]** $A > 0, B > 0$ のとき、 $A > B \iff A^2 > B^2$ は成り立つか。

8.  **[コーシー・シュワルツ]** $(a^2+b^2)(x^2+y^2) \ge (ax+by)^2$ の等号成立条件は何か。
    > **Condition**: $ay = bx$ （ベクトルが平行）。

9.  **[分数不等式]** $a > b > 0$ のとき、 $\frac{1}{a} < \frac{1}{b}$ は成り立つか。

10. **[プログラミング]** 浮動小数点数 `a, b` について `a + b >= a` は常に真か。
    > **Caveat**: 偽になる場合がある（オーバーフロー、NaN、負の数）。数学的実数とは異なる。

---

## Phase 2: Applied Mastery (応用・実践 10問)

**指針**: 「条件を使い切ったか確認せよ」。相加相乗平均は「正の数」「逆数和」の形を見たら反応せよ。

11. **[差をとる証明]**
    $a > b > 0$ のとき、 $a^3 - b^3 > ab(a-b)$ を証明せよ。
    > **Proof**: 左辺 - 右辺 = $(a-b)(a^2+ab+b^2) - ab(a-b) = (a-b)(a^2+b^2) > 0$。

12. **[相加相乗平均]**
    $x > 0$ のとき、 $x + \frac{4}{x}$ の最小値を求めよ。
    > **Calculation**: $2\sqrt{x \cdot 4/x} = 4$。

13. **[相加相乗平均（展開）]**
    $a > 0, b > 0$ のとき、 $(a + \frac{1}{b})(b + \frac{4}{a})$ の最小値を求めよ。
    > **Algorithm**: 展開してから適用。 $ab + 4 + 1 + 4/ab = 5 + ab + 4/ab \ge 5 + 4 = 9$。

14. **[三角不等式の利用]**
    $|a| < 1, |b| < 1$ のとき、 $|a+b| < 1 + ab$ を証明せよ。
    > **Proof**: 両辺正なので平方の差をとる。 $(1+ab)^2 - (a+b)^2 = (1-a^2)(1-b^2) > 0$。

15. **[コーシー・シュワルツの利用]**
    $x^2 + y^2 = 1$ のとき、 $3x + 4y$ の最大値を求めよ。
    > **Calculation**: $(3^2+4^2)(x^2+y^2) \ge (3x+4y)^2 \Rightarrow 25 \ge (3x+4y)^2$。最大値 5。

16. **[3変数の相加相乗]**
    $a, b, c > 0$ のとき、 $a+b+c \ge 3\sqrt[3]{abc}$ を用いて、 $\frac{a}{b} + \frac{b}{c} + \frac{c}{a} \ge 3$ を証明せよ。

17. **[条件付き不等式]**
    $a+b+c=1, a, b, c > 0$ のとき、 $a^2 + b^2 + c^2 \ge \frac{1}{3}$ を証明せよ。
    > **Proof**: コーシー・シュワルツ $(1^2+1^2+1^2)(a^2+b^2+c^2) \ge (a+b+c)^2$。

18. **[並べ替え不等式]** (発展)
    $a_1 \le a_2, b_1 \le b_2$ のとき、 $a_1 b_1 + a_2 b_2 \ge a_1 b_2 + a_2 b_1$ を証明せよ。
    > **Proof**: $(a_2-a_1)(b_2-b_1) \ge 0$ を展開。

19. **[凸不等式]** (発展)
    $f(x) = x^2$ が凸関数であることを利用して、 $(\frac{a+b}{2})^2 \le \frac{a^2+b^2}{2}$ を説明せよ。
    > **Term**: イェンゼンの不等式 (Jensen's Inequality)。

20. **[プログラミング: 浮動小数点]**
    `x > 0` のとき、 `x + 1/x` を計算して最小値 2 を期待するテストコードを書いたが、 `x = 1e-10` で失敗した。理由を述べよ。
    > **Tech**: オーバーフローまたは精度不足。 `1/1e-10` は `1e10` となり表現可能だが、 `x` が極端に小さい/大きいと丸め誤差の影響が出る（このケースでは `1e10` なので `2` 以上は保たれるが、 `x=2` 付近での `2.0000000001` などの判定に注意）。

---

## 解答と解説

### Phase 1

1.  **$A - B > 0$ を示す**
2.  **$0$**
3.  **証明**
    *   $(x+2)^2 + 1 \ge 1 > 0$。
4.  **$\frac{a+b}{2} \ge \sqrt{ab}$**
5.  **$a = b$**
6.  **三角不等式**
7.  **成り立つ**
8.  **$a:b = x:y$ ($ay=bx$)**
9.  **成り立つ**
10. **偽**
    *   `b` が負の場合や、 `a` が `NaN` の場合。

### Phase 2

11. **証明**
    *   差をとって因数分解。 $(a-b)(a^2+b^2)$。 $a>b, a^2+b^2>0$ より正。
12. **4**
    *   等号成立は $x = 4/x \Rightarrow x=2$。
13. **9**
    *   等号成立は $ab = 4/ab \Rightarrow ab=2$。
14. **証明**
    *   $(1+ab)^2 - (a+b)^2 = 1 + 2ab + a^2b^2 - (a^2 + 2ab + b^2) = 1 - a^2 - b^2 + a^2b^2 = (1-a^2)(1-b^2)$。
    *   $|a|<1, |b|<1$ より $1-a^2>0, 1-b^2>0$。よって正。
15. **5**
    *   $25 \ge (3x+4y)^2$。 $-5 \le 3x+4y \le 5$。
16. **証明**
    *   相加相乗平均より $\frac{a}{b} + \frac{b}{c} + \frac{c}{a} \ge 3 \sqrt[3]{\frac{a}{b}\frac{b}{c}\frac{c}{a}} = 3 \sqrt[3]{1} = 3$。
17. **証明**
    *   $3(a^2+b^2+c^2) \ge (a+b+c)^2 = 1$。
    *   $a^2+b^2+c^2 \ge 1/3$。
18. **証明**
    *   $a_1 b_1 + a_2 b_2 - a_1 b_2 - a_2 b_1 = a_1(b_1-b_2) + a_2(b_2-b_1) = (a_2-a_1)(b_2-b_1)$。
    *   順序が同じなら非負。
19. **解説**
    *   グラフ上の2点の中点は、グラフ（曲線）よりも上側にある。
20. **解説**
    *   `x` が非常に小さい場合、 `1/x` が非常に大きくなり、 `x` の加算が情報落ちで無視される可能性があるが、不等式自体は成立する。
    *   テスト失敗の理由としては、 `x=1.0` での等号判定に `assert(result > 2.0)` を使ってしまった（等号を含めなかった）などが考えられる。

