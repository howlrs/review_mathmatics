# 数学I: データの分析 (1) データの代表値 (Session 19)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: データの代表値（平均値、中央値、最頻値）の定義と特性を理解し、データの分布を要約する力を養う。これはログ解析やパフォーマンス計測の基礎である。

---

## Phase 1: Foundational Check (基礎確認 10問)

**指針**: 「困ったときは『定義』に還れ」。各代表値がデータのどのような側面を捉えているかを意識せよ。

1.  **[平均値]** 次のデータ $x$ の平均値 $\bar{x}$ を求めよ。
    $$ 3, 5, 7, 9, 11 $$
    > **Prog Link**: `sum(data) / len(data)`。

2.  **[中央値]** 次のデータの中央値 (Median) を求めよ。
    $$ 4, 1, 8, 5, 2 $$
    > **Algorithm**: ソート `sort(data)` して真ん中の要素を取得。奇数個なら `data[n/2]`。

3.  **[中央値（偶数個）]** 次のデータの中央値を求めよ。
    $$ 2, 8, 4, 6, 10, 12 $$
    > **Algorithm**: 偶数個なら真ん中の2つの平均。 `(data[n/2-1] + data[n/2]) / 2`。

4.  **[最頻値]** 次のデータの最頻値 (Mode) を求めよ。
    $$ 1, 2, 3, 2, 4, 2, 5 $$
    > **Prog Link**: ハッシュマップ（度数分布表）を作成し、最大カウントのキーを探す。

5.  **[外れ値の影響]** データ $1, 2, 3, 4, 100$ の平均値と中央値を求めよ。どちらが外れ値の影響を受けにくいか。
    > **Maxim**: 「なぜ？は理解のエンジン」。ロバスト統計 (Robust Statistics) の重要性。

6.  **[仮平均]** データ $x$ が $102, 105, 108, 101, 104$ であるとき、仮平均を $100$ として平均値を求めよ。
    > **Prog Link**: オーバーフロー防止のためのオフセット計算。

7.  **[度数分布表]** 次の度数分布表から、最頻値（階級値）を求めよ。
    | 階級  | 度数 |
    | :---- | :--- |
    | 0-10  | 2    |
    | 10-20 | 5    |
    | 20-30 | 3    |

8.  **[ヒストグラム]** ヒストグラムにおいて、長方形の面積の総和は何を表しているか。

9.  **[データの変換]** 変量 $x$ の平均値が $\bar{x}=10$ のとき、新しい変量 $u = 2x + 3$ の平均値 $\bar{u}$ を求めよ。
    > **Prog Link**: 線形変換 $y = ax + b$ に対する平均の線形性。

10. **[箱ひげ図]** 箱ひげ図 (Box Plot) の「箱」の上下端は何を表しているか。
    > **Tip**: 第1四分位数 ($Q_1$) と第3四分位数 ($Q_3$)。

---

## Phase 2: Applied Mastery (応用・実践 10問)

**指針**: 「条件を使い切ったか確認せよ」。データの一部が不明な場合や、複数のグループを統合する場合の計算手順を確立せよ。

11. **[未知のデータ]**
    5人のテストの点数が $70, 85, 60, x, 90$ で、平均点が $78$ 点であるとき、 $x$ の値を求めよ。

12. **[統合データの平均]**
    男子20人の平均点が60点、女子30人の平均点が70点のとき、クラス全体の平均点を求めよ。
    > **Algorithm**: 加重平均 (Weighted Mean)。 $(n_1 \bar{x}_1 + n_2 \bar{x}_2) / (n_1 + n_2)$。

13. **[中央値の性質]**
    データ $x_1, x_2, \dots, x_n$ の中央値を $M$ とするとき、 $\sum |x_i - a|$ を最小にする $a$ の値は何か。
    > **Prog Link**: L1ノルム最小化問題（最小絶対偏差回帰）。

14. **[平均値の性質]**
    データ $x_1, x_2, \dots, x_n$ の平均値を $\bar{x}$ とするとき、 $\sum (x_i - a)^2$ を最小にする $a$ の値は何か。
    > **Prog Link**: L2ノルム最小化問題（最小二乗法）。

15. **[四分位数]**
    次のデータの第1四分位数 ($Q_1$)、第2四分位数 ($Q_2$)、第3四分位数 ($Q_3$) を求めよ。
    $$ 3, 4, 7, 8, 10, 13, 15, 19 $$
    > **Algorithm**: データを半分に分け、さらにその半分の中央値をとる。

16. **[四分位範囲]**
    前問のデータの四分位範囲 (IQR) と四分位偏差を求めよ。
    > **Tip**: IQR = $Q_3 - Q_1$。外れ値の検出基準 ($1.5 \times \text{IQR}$) に使われる。

17. **[データの修正]**
    10人のデータがあり、平均値は50だった。しかし、1人のデータ「40」が誤りで、正しくは「60」だった。修正後の平均値を求めよ。
    > **Prog Link**: 差分更新 (Incremental Update)。再計算コストの削減。

18. **[度数分布表の平均]**
    次の度数分布表から平均値を求めよ。
    | 階級値 ($x$) | 度数 ($f$) |
    | :----------- | :--------- |
    | 10           | 2          |
    | 20           | 5          |
    | 30           | 3          |
    > **Formula**: $\bar{x} = \frac{\sum f x}{\sum f}$。

19. **[代表値の選択]**
    年収データのように、少数の極端に大きな値が含まれる分布（右に裾が長い分布）において、最も実感に近い代表値はどれか。理由とともに答えよ。

20. **[分散の導入]** (Session 20への導入)
    平均値からの偏差の総和 $\sum (x_i - \bar{x})$ は常にいくつになるか。
    > **Logic**: 定義より $\sum x_i - \sum \bar{x} = n\bar{x} - n\bar{x} = 0$。だからこそ2乗して分散を考える。

---

## 解答と解説

### Phase 1

1.  **7**
    *   $(3+5+7+9+11)/5 = 35/5 = 7$。
2.  **4**
    *   ソート: $1, 2, 4, 5, 8$。中央は4。
3.  **7**
    *   ソート: $2, 4, 6, 8, 10, 12$。中央は6と8。 $(6+8)/2 = 7$。
4.  **2**
    *   2が3回出現。
5.  **平均値: 22, 中央値: 3。中央値の方が影響を受けにくい。**
    *   平均: $(1+2+3+4+100)/5 = 110/5 = 22$。
    *   中央値: 3。
6.  **104**
    *   偏差: $+2, +5, +8, +1, +4$。和: $20$。平均偏差: $20/5 = 4$。
    *   $100 + 4 = 104$。
7.  **15**
    *   度数が最大の階級は 10-20。階級値は $(10+20)/2 = 15$。
8.  **度数の総和（データの総数）**
9.  **23**
    *   $\bar{u} = 2\bar{x} + 3 = 2(10) + 3 = 23$。
10. **第3四分位数 ($Q_3$) と第1四分位数 ($Q_1$)**

### Phase 2

11. **85**
    *   合計点: $78 \times 5 = 390$。
    *   既知の合計: $70+85+60+90 = 305$。
    *   $x = 390 - 305 = 85$。
12. **66点**
    *   $(20 \times 60 + 30 \times 70) / 50 = (1200 + 2100) / 50 = 3300 / 50 = 66$。
13. **中央値 ($M$)**
    *   絶対値の和を最小にするのは中央値。
14. **平均値 ($\bar{x}$)**
    *   二乗和を最小にするのは平均値。
15. **$Q_1=5.5, Q_2=9, Q_3=14$**
    *   データ: $3, 4, 7, 8, | 10, 13, 15, 19$ (8個)。
    *   $Q_2 = (8+10)/2 = 9$。
    *   前半: $3, 4, 7, 8$。 $Q_1 = (4+7)/2 = 5.5$。
    *   後半: $10, 13, 15, 19$。 $Q_3 = (13+15)/2 = 14$。
16. **IQR: 8.5, 四分位偏差: 4.25**
    *   IQR $= 14 - 5.5 = 8.5$。
    *   四分位偏差 $= 8.5 / 2 = 4.25$。
17. **52**
    *   元の合計: $50 \times 10 = 500$。
    *   修正後の合計: $500 - 40 + 60 = 520$。
    *   修正後の平均: $520 / 10 = 52$。
18. **21**
    *   $\sum fx = 10 \times 2 + 20 \times 5 + 30 \times 3 = 20 + 100 + 90 = 210$。
    *   $\sum f = 2 + 5 + 3 = 10$。
    *   $\bar{x} = 210 / 10 = 21$。
19. **中央値**
    *   平均値は極端な高額所得者に引きずられて高くなるため、大多数の実感とは乖離する。中央値の方が分布の「真ん中」を適切に表す。
20. **0**
    *   $\sum (x_i - \bar{x}) = \sum x_i - \sum \bar{x} = n\bar{x} - n\bar{x} = 0$。

