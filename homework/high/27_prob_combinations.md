# 数学A: 場合の数 (3) 組合せ (Session 27)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: 組合せ ($nCr$) の定義と計算方法を習得し、重複組合せや二項定理への応用を理解する。

---

## Phase 1: Foundational Check (基礎確認 10問)

**指針**: 「困ったときは『定義』に還れ」。組合せとは「選ぶだけ」で、並び順を区別しないことである。

1.  **[組合せの定義]** 異なる $n$ 個のものから $r$ 個を選ぶ組合せの総数 $_nC_r$ の式を、階乗を用いて表せ。
    > **Prog Link**: $_nC_r = \frac{_nP_r}{r!} = \frac{n!}{r!(n-r)!}$。

2.  **[計算]** $_6C_2$ の値を求めよ。

3.  **[性質]** $_nC_r = _nC_{n-r}$ が成り立つことを、具体例 $_5C_2 = _5C_3$ で確認せよ。
    > **Logic**: 「選ぶ」ことは「選ばないものを決める」ことと等価。

4.  **[性質]** $_nC_0$ の値はいくつか。

5.  **[図形]** 正六角形の頂点3つを結んでできる三角形は何個あるか。

6.  **[組分け]** 6人を3人ずつの2組（Aチーム、Bチーム）に分ける方法は何通りか。

7.  **[組分け（区別なし）]** 6人を3人ずつの2組（チーム名なし）に分ける方法は何通りか。
    > **Logic**: A, Bの区別をなくすため、 $2!$ で割る。

8.  **[重複組合せ]** 3種類のアイスクリームから重複を許して4個選ぶ方法 $_nH_r$ の計算式は $_nC_r$ を使ってどう表されるか。
    > **Formula**: $_{n+r-1}C_r$。仕切り棒の考え方。

9.  **[二項定理]** $(a+b)^4$ の展開式における $a^2 b^2$ の係数を求めよ。
    > **Prog Link**: パスカルの三角形。

10. **[パスカルの三角形]** $_nC_r = _{n-1}C_{r-1} + _{n-1}C_r$ が成り立つことを、パスカルの三角形の性質として説明せよ。
    > **Algorithm**: 動的計画法 (DP) による組合せ計算の漸化式。

---

## Phase 2: Applied Mastery (応用・実践 10問)

**指針**: 「『解き方』は一つにあらず」。重複組合せや最短経路問題など、一見異なる問題を「組合せ」に帰着させる視点を持て。

11. **[特定の要素を含む]**
    1から10までの数字から異なる3個を選ぶとき、必ず1を含む選び方は何通りか。
    > **Logic**: 1を先に選び、残り9個から2個選ぶ。

12. **[少なくとも1つ]**
    男子5人、女子4人から4人の委員を選ぶとき、少なくとも女子が1人含まれる選び方は何通りか。
    > **Maxim**: 「『少なくとも』は『余事象』を疑え」。全体 - 全員男子。

13. **[重複組合せの計算]**
    3個の文字 x, y, z から重複を許して5個取る組合せは何通りか。
    > **Formula**: $_{3+5-1}C_5 = _7C_5 = _7C_2$。

14. **[整数解の個数]**
    方程式 $x + y + z = 10$ を満たす負でない整数解 $(x, y, z)$ の組は何個あるか。
    > **Logic**: 重複組合せと同値。10個のボールと2つの仕切り。

15. **[正の整数解]**
    方程式 $x + y + z = 10$ を満たす正の整数解 $(x, y, z)$ の組は何個あるか。
    > **Tip**: $x' = x-1$ と置換して非負整数解の問題に帰着させる。

16. **[最短経路]**
    右図のような格子状の道（横5マス、縦4マス）がある。A地点からB地点への最短経路は何通りか。
    > **Formula**: $_{5+4}C_4$。

17. **[多項定理]**
    $(a+b+c)^6$ の展開式における $a^2 b^3 c$ の係数を求めよ。
    > **Formula**: $6! / (2! 3! 1!)$。

18. **[部分集合の和]**
    集合 $\{1, 2, 3, 4, 5\}$ の部分集合のうち、要素の和が10になるものは何通りあるか。
    > **Algorithm**: ナップサック問題的な探索、または列挙。

19. **[組合せの和]**
    $_nC_0 + _nC_1 + \dots + _nC_n = 2^n$ を二項定理を用いて証明せよ。

20. **[プログラミング]**
    $_nC_r$ を計算する関数 `combinations(n, r)` を実装する際、 `factorial(n) / (factorial(r) * factorial(n-r))` とするとオーバーフローしやすい。これを回避する計算手順を述べよ。
    > **Prog Link**: 乗算と除算を交互に行う、またはパスカルの三角形（加算のみ）を使う。

---

## 解答と解説

### Phase 1

1.  **$n! / (r!(n-r)!)$**
2.  **15**
    *   $(6 \times 5) / (2 \times 1) = 15$。
3.  **確認**
    *   $_5C_2 = 10, _5C_3 = 10$。
4.  **1**
5.  **20個**
    *   $_6C_3 = (6 \times 5 \times 4) / (3 \times 2 \times 1) = 20$。
6.  **20通り**
    *   $_6C_3 = 20$。残りは自動的に決まる。
7.  **10通り**
    *   $20 / 2! = 10$。
8.  **$_{n+r-1}C_r$**
9.  **6**
    *   $_4C_2 = 6$。
10. **解説**
    *   上の2つの数を足すと下の数になる。

### Phase 2

11. **36通り**
    *   $_9C_2 = (9 \times 8) / 2 = 36$。
12. **121通り**
    *   全体 $_9C_4 = (9 \cdot 8 \cdot 7 \cdot 6) / 24 = 126$。
    *   全員男子 $_5C_4 = 5$。
    *   $126 - 5 = 121$。
13. **21通り**
    *   $_7C_2 = 21$。
14. **66個**
    *   $_{3+10-1}C_{10} = _{12}C_{10} = _{12}C_2 = 66$。
15. **36個**
    *   $x-1, y-1, z-1 \ge 0$。和は $10-3=7$。
    *   $_{3+7-1}C_7 = _9C_7 = _9C_2 = 36$。
16. **126通り**
    *   $_9C_4 = 126$。
17. **60**
    *   $720 / (2 \times 6 \times 1) = 60$。
18. **3通り**
    *   $\{1, 2, 3, 4\}$ (10)
    *   $\{1, 4, 5\}$ (10)
    *   $\{2, 3, 5\}$ (10)
    *   $\{1, 9\}$ なし。 $\{2, 8\}$ なし... 5までしか使えない。
    *   3個の場合: 上記3つ。
    *   2個の場合: $\{5, 5\}$ 不可。
    *   4個の場合: $1+2+3+4=10$ (OK)。
    *   答え: $\{1,2,3,4\}, \{1,4,5\}, \{2,3,5\}$ の3通り。
19. **証明**
    *   $(1+1)^n = _nC_0 1^n + _nC_1 1^{n-1} + \dots = \sum _nC_k$。
20. **解説**
    *   `result = 1; for i in 1..r { result = result * (n - i + 1) / i; }` のように、掛けてから割るを繰り返す（ただし割り切れる保証が必要）。
    *   または `BigInt` を使う。

