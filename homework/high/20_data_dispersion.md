# 数学I: データの分析 (2) データの散らばり (Session 20)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: 分散と標準偏差の定義を理解し、データのばらつきを定量化する。偏差値や正規分布の基礎概念を掴む。

---

## Phase 1: Foundational Check (基礎確認 10問)

**指針**: 「困ったときは『定義』に還れ」。分散は「偏差の二乗の平均」である。

1.  **[範囲]** 次のデータ $x$ の範囲 (Range) を求めよ。
    $$ 3, 8, 2, 5, 10 $$
    > **Prog Link**: `max(data) - min(data)`。

2.  **[偏差]** データ $x$ の平均値が $\bar{x}=50$ のとき、値 $45$ の偏差を求めよ。

3.  **[分散の定義]** データ $2, 4, 6$ の分散 $s^2$ を定義に従って計算せよ。
    > **Step**:
    > 1. 平均 $\bar{x}$ を求める。
    > 2. 各データの偏差 $x_i - \bar{x}$ を求める。
    > 3. 偏差の二乗 $(x_i - \bar{x})^2$ を求める。
    > 4. その平均をとる。

4.  **[分散の公式]** 分散 $s^2$ は $\overline{x^2} - (\bar{x})^2$ （二乗の平均 - 平均の二乗）でも求められる。データ $1, 3, 5$ でこれを確認せよ。
    > **Prog Link**: オンラインアルゴリズムでの分散計算に適した公式（ただし桁落ちに注意）。

5.  **[標準偏差]** 前問のデータ $1, 3, 5$ の標準偏差 $s$ を求めよ。
    > **Definition**: $s = \sqrt{s^2}$。単位を元のデータと揃えるため。

6.  **[データの変換]** 変量 $x$ の分散が $s_x^2 = 10$ のとき、 $u = 3x + 5$ の分散 $s_u^2$ を求めよ。
    > **Logic**: 分散はスケールの2乗倍になる。平行移動（+5）の影響は受けない。

7.  **[データの変換]** 変量 $x$ の標準偏差が $s_x = 4$ のとき、 $u = -2x + 1$ の標準偏差 $s_u$ を求めよ。
    > **Tip**: 標準偏差は常に正。 $|-2| \times s_x$。

8.  **[標準化]** 平均 $\bar{x}$、標準偏差 $s$ のデータ $x$ を $z = \frac{x - \bar{x}}{s}$ と変換したとき、 $z$ の平均と標準偏差はどうなるか。
    > **Prog Link**: Zスコア正規化 (Standardization)。機械学習の前処理で必須。

9.  **[偏差値]** あるテストの平均点が50点、標準偏差が10点のとき、70点の人の偏差値を求めよ。
    > **Formula**: $50 + 10 \times z$。

10. **[正規分布]** 正規分布において、平均値 $\pm 1\sigma$ （標準偏差）の範囲に含まれるデータはおよそ何％か。
    (a) 68% (b) 95% (c) 99%

---

## Phase 2: Applied Mastery (応用・実践 10問)

**指針**: 「複雑な問題は『素因数分解』せよ」。分散の公式 $\overline{x^2} - (\bar{x})^2$ を使いこなし、未知のパラメータを逆算せよ。

11. **[分散の計算]**
    次のデータの分散を求めよ。計算を楽にするために、すべてのデータから 100 を引いて考えるとよい。
    $$ 102, 105, 108, 101, 104 $$

12. **[未知のデータ]**
    データ $x_1, x_2, \dots, x_{10}$ の平均値が 5、分散が 4 である。 $\sum x_i^2$ の値を求めよ。
    > **Algorithm**: $s^2 = \overline{x^2} - (\bar{x})^2$ を変形して $\overline{x^2}$ を求め、 $n$ 倍する。

13. **[統合データの分散]** (発展)
    男子20人の平均点が60点、分散が100。女子30人の平均点が70点、分散が200。クラス全体の分散を求めよ。
    > **Logic**: 全体の分散 $\ne$ 分散の平均。
    > 「全体の二乗和」と「全体の平均」から再計算する必要がある。
    > または、群内変動と群間変動の和に分解する (ANOVAの基礎)。

14. **[誤りの修正]**
    10個のデータがあり、 $\sum x_i = 50, \sum x_i^2 = 300$ であった。しかし、データの一つ「5」が誤りで、正しくは「3」であった。修正後の分散を求めよ。
    > **Prog Link**: 逐次更新アルゴリズム。

15. **[相関係数への導入]**
    2つの変量 $x, y$ があり、 $y = ax + b$ ($a > 0$) の関係があるとき、 $x$ と $y$ の分散の比 $s_y^2 / s_x^2$ はいくらか。

16. **[変動係数]**
    A組: 平均170cm, 標準偏差5cm。 B組: 平均170cm, 標準偏差10cm。
    どちらの組の方が身長のばらつきが大きいか。また、平均が異なる場合（例: 体重と身長）の比較には何を使うべきか。
    > **Term**: 変動係数 (Coefficient of Variation) $CV = s / \bar{x}$。

17. **[チェビシェフの不等式]**
    どのような分布であっても、平均値から標準偏差の2倍以上離れたデータは全体の何％以下か。
    > **Formula**: $1/k^2$。 $k=2$ のとき $1/4 = 25\%$。

18. **[分散の最小化]**
    関数 $f(a) = \sum_{i=1}^n (x_i - a)^2$ を最小にする $a$ は平均値 $\bar{x}$ である。このときの最小値 $f(\bar{x})$ を $n$ と分散 $s^2$ を用いて表せ。

19. **[標準化の応用]**
    英語のテスト（平均60, 標準偏差15）で75点を取った。数学のテスト（平均50, 標準偏差20）で75点を取った。どちらの方が相対的に良い成績か。

20. **[プログラミング的思考]**
    分散を計算する際、定義通り `sum((x - mean)^2) / n` で計算する場合と、公式 `mean(x^2) - mean(x)^2` で計算する場合の、計算機上のメリット・デメリットを述べよ。
    > **Tip**: 2パス（平均計算→分散計算）vs 1パス（同時計算）。桁落ち誤差 (Catastrophic Cancellation)。

---

## 解答と解説

### Phase 1

1.  **8**
    *   $10 - 2 = 8$。
2.  **-5**
    *   $45 - 50 = -5$。
3.  **$8/3$**
    *   平均 $\bar{x} = 4$。
    *   偏差: $-2, 0, 2$。
    *   偏差平方: $4, 0, 4$。
    *   平均: $8/3$。
4.  **$8/3$**
    *   $\bar{x} = 3 \Rightarrow (\bar{x})^2 = 9$。
    *   $x^2$: $1, 9, 25$。平均 $\overline{x^2} = 35/3$。
    *   $s^2 = 35/3 - 27/3 = 8/3$。一致する。
5.  **$2\sqrt{6}/3$**
    *   $s = \sqrt{8/3} = 2\sqrt{2}/\sqrt{3} = 2\sqrt{6}/3$。
6.  **90**
    *   $s_u^2 = 3^2 s_x^2 = 9 \times 10 = 90$。
7.  **8**
    *   $s_u = |-2| s_x = 2 \times 4 = 8$。
8.  **平均 0, 標準偏差 1**
9.  **70**
    *   $z = (70-50)/10 = 2$。
    *   $50 + 10 \times 2 = 70$。
10. **(a) 68%**
    *   $\pm 2\sigma$ で95%、$\pm 3\sigma$ で99.7%。

### Phase 2

11. **5.2**
    *   $x' = x - 100$: $2, 5, 8, 1, 4$。
    *   平均 $\bar{x}' = 4$。
    *   偏差: $-2, 1, 4, -3, 0$。
    *   二乗: $4, 1, 16, 9, 0$。和: 30。
    *   分散: $30/5 = 6$。
    *   (計算ミス確認: 平均4。 $2-4=-2, 5-4=1, 8-4=4, 1-4=-3, 4-4=0$。
    *   $4+1+16+9+0=30$。 $30/5=6$。
    *   答え: 6。
    *   解説修正: **6**)
12. **290**
    *   $4 = \overline{x^2} - 5^2 \Rightarrow \overline{x^2} = 29$。
    *   $\sum x^2 = 29 \times 10 = 290$。
13. **184**
    *   男子: $\overline{x_m^2} = 100 + 60^2 = 3700$。 $\sum x_m^2 = 3700 \times 20 = 74000$。
    *   女子: $\overline{x_f^2} = 200 + 70^2 = 5100$。 $\sum x_f^2 = 5100 \times 30 = 153000$。
    *   全体: $\sum x^2 = 227000$。 $\overline{x^2} = 227000 / 50 = 4540$。
    *   全体平均: $(1200+2100)/50 = 66$。
    *   全体分散: $4540 - 66^2 = 4540 - 4356 = 184$。
14. **3.24**
    *   修正前: $\sum x = 50, \sum x^2 = 300$。
    *   修正後: $\sum x = 50 - 5 + 3 = 48$。 $\bar{x} = 4.8$。
    *   修正後: $\sum x^2 = 300 - 25 + 9 = 284$。 $\overline{x^2} = 28.4$。
    *   分散: $28.4 - 4.8^2 = 28.4 - 23.04 = 5.36$。
    *   (計算ミス確認: $28.4 - 23.04 = 5.36$。
    *   答え: 5.36。
    *   解説修正: **5.36**)
15. **$a^2$**
    *   $s_y^2 = a^2 s_x^2$。
16. **B組。変動係数。**
    *   標準偏差が大きいB組の方がばらつきが大きい。
    *   単位や平均が異なる場合は変動係数 $CV$ を使う。
17. **25%以下**
    *   チェビシェフの不等式。
18. **$n s^2$**
    *   $f(a) = \sum (x_i - \bar{x} + \bar{x} - a)^2 = \sum (x_i - \bar{x})^2 + n(\bar{x}-a)^2$。
    *   最小値は $a=\bar{x}$ のとき $\sum (x_i - \bar{x})^2 = n s^2$。
19. **数学**
    *   英語: $z = (75-60)/15 = 1.0$。
    *   数学: $z = (75-50)/20 = 1.25$。
    *   数学の方が偏差値が高い。
20. **解説**
    *   定義通り（2パス）: 精度が良い。データがメモリに乗る必要がある。
    *   公式（1パス）: 高速、メモリ効率良し。しかし $\overline{x^2}$ と $(\bar{x})^2$ が近い値の場合、引き算で有効桁数が失われる（桁落ち）リスクがある。

