# 数学A: 図形の性質 (4) 円の性質 II (Session 34)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: 方べきの定理を習得し、円と直線の交差関係における長さの計算をマスターする。また、反転幾何学などの高度なトピックへの入り口とする。

---

## Phase 1: Foundational Check (基礎確認 10問)

**指針**: 「困ったときは『定義』に還れ」。方べきの定理は「相似な三角形の辺の比」から導かれる。

1.  **[方べきの定理 I]** 円の2つの弦 $AB, CD$ が円内部の点 $P$ で交わるとき、成り立つ等式を記述せよ。
    > **Formula**: $PA \cdot PB = PC \cdot PD$。

2.  **[方べきの定理 II]** 円の2つの弦 $AB, CD$ の延長が円外部の点 $P$ で交わるとき、成り立つ等式を記述せよ。
    > **Formula**: $PA \cdot PB = PC \cdot PD$ （形式は同じ）。

3.  **[方べきの定理 III]** 円の弦 $AB$ の延長と、点 $T$ での接線が点 $P$ で交わるとき、成り立つ等式を記述せよ。
    > **Formula**: $PA \cdot PB = PT^2$。

4.  **[計算]** 円内部の点 $P$ を通る弦 $AB, CD$ について、 $PA=3, PB=4, PC=2$ のとき、 $PD$ の長さを求めよ。

5.  **[計算]** 円外部の点 $P$ から引いた割線 $PAB$ ($A, B$は交点) と $PCD$ について、 $PA=2, AB=4, PC=3$ のとき、 $CD$ の長さを求めよ。
    > **Tip**: $PB = PA + AB = 6$。

6.  **[接線の長さ]** 円外部の点 $P$ から引いた接線 $PT$ と割線 $PAB$ について、 $PA=4, AB=5$ のとき、 $PT$ の長さを求めよ。
    > **Calculation**: $PT^2 = 4 \times 9 = 36$。

7.  **[方べきの定理の逆]** 2つの線分 $AB, CD$ が点 $P$ で交わり、 $PA \cdot PB = PC \cdot PD$ が成り立つとき、4点 $A, B, C, D$ はどのような位置関係にあるか。
    > **Logic**: 同一円周上にある。

8.  **[共通接線]** 2つの円の共通接線の交点は、2つの円の中心を結ぶ線分をどのように分割するか。
    > **Logic**: 半径の比に内分（内接線）または外分（外接線）する。

9.  **[円の直交]** 2つの円が直交するとは、交点における何が直交することを意味するか。
    > **Term**: 接線同士。

10. **[プログラミング]** 点 $P(x, y)$ と円 $x^2 + y^2 = r^2$ について、式 $x^2 + y^2 - r^2$ の値を何というか。
    > **Term**: 点 $P$ の円に対する「方べき (Power of a Point)」。

---

## Phase 2: Applied Mastery (応用・実践 10問)

**指針**: 「条件を使い切ったか確認せよ」。方べきの定理は、長さの積が一定であることを利用して、未知の長さを求める強力なツールである。

11. **[方べきの利用]**
    半径 $r$ の円の中心 $O$ から距離 $d$ ($d > r$) の点 $P$ を通る割線 $PAB$ を引く。 $PA \cdot PB$ の値を $r, d$ で表せ。
    > **Formula**: $d^2 - r^2$。

12. **[方べきの利用（内部）]**
    半径 $r$ の円の中心 $O$ から距離 $d$ ($d < r$) の点 $P$ を通る弦 $AB$ を引く。 $PA \cdot PB$ の値を $r, d$ で表せ。
    > **Formula**: $r^2 - d^2$。

13. **[共通弦]**
    2つの円が2点 $A, B$ で交わっている。直線 $AB$ 上の点 $P$ からそれぞれの円に引いた接線の長さは等しいことを証明せよ。
    > **Logic**: 方べきの定理より $PT_1^2 = PA \cdot PB = PT_2^2$。

14. **[根軸]**
    2つの円に対して、方べきの値が等しくなる点の軌跡を何というか。
    > **Term**: 根軸 (Radical Axis)。2円の交点を通る直線（またはその延長）。

15. **[作図]**
    長さ $a, b$ の線分が与えられたとき、長さ $\sqrt{ab}$ の線分を作図する方法を方べきの定理を用いて説明せよ。
    > **Algorithm**: 直径 $a+b$ の円を描き、分点から垂線を立てる（方べき、または射影定理）。

16. **[円と四角形]**
    四角形 $ABCD$ の対角線の交点を $P$ とする。 $PA=2, PB=6, PC=3, PD=4$ のとき、この四角形は円に内接するか。
    > **Check**: $2 \times 3 = 6, 6 \times 4 = 24$。等しくないので内接しない。
    > **Correction**: $PA \cdot PC = PB \cdot PD$ ? $2 \times 3 = 6, 6 \times 4 = 24$。違う。
    > 対角線 $AC, BD$。 $PA \cdot PC = 6$。 $PB \cdot PD = 24$。
    > 答え: 内接しない。

17. **[円束]** (発展)
    2つの円 $C_1: x^2+y^2=1$ と $C_2: (x-2)^2+y^2=4$ の交点を通る円の方程式を、パラメータ $k$ を用いて表せ。
    > **Formula**: $C_1 + kC_2 = 0$。

18. **[反転幾何]** (発展)
    中心 $O$、半径 $R$ の円に関する反転において、点 $P$ が点 $P'$ に移るとき、 $OP \cdot OP'$ の値はいくらか。
    > **Formula**: $R^2$。

19. **[ケージーの定理]** (発展)
    4つの円が第5の円に接しているときの関係式。トレミーの定理の拡張。

20. **[プログラミング: 幾何ライブラリ]**
    円と直線の交点を求める際、判別式 $D < 0$ の場合は「交差なし」だが、浮動小数点数の誤差で $D = -0.0000001$ となる場合がある。どう処理すべきか。
    > **Tech**: `D > -EPSILON` なら `D = 0` とみなして接点計算を行う（Robust Predicates）。

---

## 解答と解説

### Phase 1

1.  **$PA \cdot PB = PC \cdot PD$**
2.  **$PA \cdot PB = PC \cdot PD$**
3.  **$PA \cdot PB = PT^2$**
4.  **6**
    *   $3 \times 4 = 2 \times PD \Rightarrow 12 = 2 PD \Rightarrow PD = 6$。
5.  **1**
    *   $PA \cdot PB = 2 \times (2+4) = 12$。
    *   $PC \cdot PD = 3 \times (3+CD) = 12 \Rightarrow 3+CD = 4 \Rightarrow CD = 1$。
6.  **6**
    *   $PT^2 = 4 \times (4+5) = 36 \Rightarrow PT = 6$。
7.  **同一円周上にある**
8.  **半径の比**
9.  **接線**
10. **方べき**

### Phase 2

11. **$d^2 - r^2$**
    *   中心を通る線を引くと、 $P$ から近い交点まで $d-r$、遠い交点まで $d+r$。
    *   $(d-r)(d+r) = d^2 - r^2$。
12. **$r^2 - d^2$**
    *   $(r-d)(r+d) = r^2 - d^2$。
13. **証明**
    *   $PT_1^2 = PA \cdot PB$。 $PT_2^2 = PA \cdot PB$。
    *   よって $PT_1 = PT_2$。
14. **根軸**
15. **解説**
    *   直径 $AB$ ($a+b$) の円を描くのではなく...
    *   直径上の点 $H$ で $AH=a, HB=b$ とし、 $H$ を通り直径に垂直な弦 $PQ$ を引く。
    *   $AH \cdot HB = PH \cdot HQ = PH^2$。
    *   $PH = \sqrt{ab}$。
16. **内接しない**
    *   $PA \cdot PC \ne PB \cdot PD$。
17. **$x^2+y^2-1 + k((x-2)^2+y^2-4) = 0$**
18. **$R^2$**
19. **解説**
    *   $t_{12} t_{34} \pm t_{13} t_{24} \pm t_{14} t_{23} = 0$。
20. **解説**
    *   許容誤差 (Epsilon) を導入し、微小な負の値は0とみなす。

