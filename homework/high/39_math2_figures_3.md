# 数学II: 図形と方程式 (3) 円の方程式 (Session 39)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: 円の方程式、円と直線の位置関係、接線の方程式を習得し、衝突判定やレンダリングにおける円の扱いに慣れる。

---

## Phase 1: Foundational Check (基礎確認 10問)

**指針**: 「困ったときは『定義』に還れ」。円とは「ある点からの距離が等しい点の集合」である。

1.  **[円の方程式]** 中心 $(a, b)$、半径 $r$ の円の方程式を求めよ。
    > **Formula**: $(x-a)^2 + (y-b)^2 = r^2$。

2.  **[一般形]** 方程式 $x^2 + y^2 - 4x + 6y - 3 = 0$ はどのような図形を表すか。中心と半径を求めよ。
    > **Algorithm**: 平方完成。 $(x-2)^2 + (y+3)^2 = 16$。

3.  **[3点を通る円]** 3点 $(0, 0), (4, 0), (0, 3)$ を通る円の方程式を求めよ。
    > **Logic**: 外接円。一般形 $x^2+y^2+lx+my+n=0$ に代入。

4.  **[円と直線の位置関係]** 円 $x^2 + y^2 = 1$ と直線 $y = x + k$ が接するとき、定数 $k$ の値を求めよ。
    > **Algorithm**: 中心 $(0,0)$ と直線の距離 $d=1$。または判別式 $D=0$。

5.  **[接線の方程式]** 円 $x^2 + y^2 = r^2$ 上の点 $(x_1, y_1)$ における接線の方程式を求めよ。
    > **Formula**: $x_1 x + y_1 y = r^2$。

6.  **[接線の方程式（平行移動）]** 円 $(x-a)^2 + (y-b)^2 = r^2$ 上の点 $(x_1, y_1)$ における接線の方程式を求めよ。
    > **Formula**: $(x_1-a)(x-a) + (y_1-b)(y-b) = r^2$。

7.  **[弦の長さ]** 円 $x^2 + y^2 = 25$ が直線 $y = 3$ から切り取る弦の長さを求めよ。
    > **Algorithm**: ピタゴラスの定理。 $\sqrt{r^2 - d^2} \times 2$。

8.  **[2円の位置関係]** 2つの円の中心間距離 $d$ と半径 $r_1, r_2$ が $d > r_1 + r_2$ を満たすとき、2円の位置関係はどうなっているか。
    > **Condition**: 互いに外部にある（離れている）。

9.  **[共通接線]** 2円 $x^2 + y^2 = 1, (x-4)^2 + y^2 = 4$ の共通接線の本数は何本か。

10. **[プログラミング]** 円の描画アルゴリズム（ミッドポイント円アルゴリズムなど）において、浮動小数点数を使わずに整数演算だけで円を描ける原理を簡単に述べよ。
    > **Tech**: 判別式 $F(x, y) = x^2 + y^2 - r^2$ の符号だけで次のピクセルを決定できるため。

---

## Phase 2: Applied Mastery (応用・実践 10問)

**指針**: 「条件を使い切ったか確認せよ」。円と直線の問題は「点と直線の距離」に帰着させるのが定石。

11. **[円外の点からの接線]**
    点 $(3, 1)$ から円 $x^2 + y^2 = 2$ に引いた接線の方程式を求めよ。
    > **Algorithm**: 接点を $(x_1, y_1)$ と置くか、傾き $m$ の直線と距離公式を使う。

12. **[共通弦の方程式]**
    2つの円 $x^2 + y^2 = 5$ と $(x-1)^2 + (y-2)^2 = 4$ の共通弦を含む直線の方程式を求めよ。
    > **Algorithm**: 2式を引き算して $x^2, y^2$ を消去する。

13. **[円と直線の交点]**
    円 $x^2 + y^2 = 10$ と直線 $y = 3x$ の交点の座標を求めよ。

14. **[弦の長さ（一般）]**
    円 $x^2 + y^2 = 4$ と直線 $y = x + 1$ の交点を $A, B$ とするとき、線分 $AB$ の長さを求めよ。

15. **[円の決定]**
    中心が直線 $y = 2x$ 上にあり、2点 $(1, 1), (3, 1)$ を通る円の方程式を求めよ。
    > **Logic**: 中心は $(1, 1)$ と $(3, 1)$ の垂直二等分線 $x=2$ 上にある。

16. **[領域と最大・最小]**
    $x^2 + y^2 \le 4$ を満たす領域において、 $x+y$ の最大値と最小値を求めよ。
    > **Logic**: 直線 $x+y=k$ が円に接するとき。

17. **[アポロニウスの円]**
    2点 $A(-2, 0), B(4, 0)$ からの距離の比が $2:1$ である点 $P$ の軌跡を求めよ。
    > **Calculation**: $AP^2 = 4PB^2$。

18. **[接する円]**
    $x$ 軸と $y$ 軸の両方に接し、点 $(2, 1)$ を通る円の方程式を求めよ。
    > **Logic**: 中心 $(r, r)$ または $(r, -r)$ ... 第1象限なので $(r, r)$。

19. **[2円の交点を通る円]** (円束)
    2円 $x^2 + y^2 = 4, (x-3)^2 + y^2 = 1$ の交点と、原点を通る円の方程式を求めよ。
    > **Formula**: $C_1 + kC_2 = 0$ に $(0, 0)$ を代入して $k$ を決定。

20. **[プログラミング: 衝突応答]**
    質量 $m$ のボール（円）が壁（直線）に完全弾性衝突したとき、速度ベクトル $\vec{v}$ はどのように変化するか。法線ベクトル $\vec{n}$ を用いて表せ。
    > **Formula**: 反射ベクトル $\vec{v'} = \vec{v} - 2(\vec{v} \cdot \vec{n})\vec{n}$。

---

## 解答と解説

### Phase 1

1.  **$(x-a)^2 + (y-b)^2 = r^2$**
2.  **中心 $(2, -3)$, 半径 $4$**
3.  **$(x-2)^2 + (y-3/2)^2 = 25/4$**
    *   中心 $(2, 3/2)$。半径 $\sqrt{4+9/4} = 5/2$。
    *   $x^2 + y^2 - 4x - 3y = 0$。
4.  **$k = \pm \sqrt{2}$**
    *   $|k|/\sqrt{2} = 1 \Rightarrow k = \pm \sqrt{2}$。
5.  **$x_1 x + y_1 y = r^2$**
6.  **$(x_1-a)(x-a) + (y_1-b)(y-b) = r^2$**
7.  **8**
    *   $d=3, r=5$。 $\sqrt{25-9} = 4$。 $4 \times 2 = 8$。
8.  **互いに外部にある**
9.  **4本**
    *   $d=4, r_1=1, r_2=2$。 $d > r_1+r_2$。
10. **判別式の符号判定**

### Phase 2

11. **$x+y-2=0, x-7y+4=0$** ... 訂正
    *   接点 $(x_1, y_1)$。 $x_1^2 + y_1^2 = 2$。 $3x_1 + y_1 = 2$。
    *   $y_1 = 2 - 3x_1$。
    *   $x_1^2 + (2-3x_1)^2 = 2 \Rightarrow 10x_1^2 - 12x_1 + 2 = 0 \Rightarrow 5x_1^2 - 6x_1 + 1 = 0$。
    *   $(5x_1 - 1)(x_1 - 1) = 0 \Rightarrow x_1 = 1, 1/5$。
    *   $x_1=1 \to y_1=-1$。接線 $x - y = 2$。
    *   $x_1=1/5 \to y_1=7/5$。接線 $1/5 x + 7/5 y = 2 \Rightarrow x + 7y = 10$。
    *   答え: $x-y-2=0, x+7y-10=0$。
    *   (計算ミス確認: $3x_1+y_1=2$。 $(3, 1)$ を通る。
    *   $x-y=2 \to 3-1=2$ OK。
    *   $x+7y=10 \to 3+7=10$ OK。
    *   解説修正: **$x-y-2=0, x+7y-10=0$**)
12. **$2x + 4y - 5 = 0$**
    *   $x^2+y^2-5 - (x^2-2x+1+y^2-4y+4-4) = 0$。
    *   $2x + 4y - 5 - 1 = 0 \Rightarrow 2x + 4y - 6 = 0 \Rightarrow x + 2y - 3 = 0$。
    *   (計算ミス確認: $x^2+y^2=5$。 $x^2-2x+1+y^2-4y+4=4 \to x^2+y^2-2x-4y+1=0$。
    *   $(x^2+y^2-5) - (x^2+y^2-2x-4y+1) = 0$。
    *   $2x + 4y - 6 = 0 \to x + 2y - 3 = 0$。
    *   解説修正: **$x+2y-3=0$**)
13. **$(1, 3), (-1, -3)$**
    *   $x^2 + 9x^2 = 10 \Rightarrow x^2 = 1$。
14. **$\sqrt{14}$**
    *   中心 $(0,0)$ と $x-y+1=0$ の距離 $d = 1/\sqrt{2}$。
    *   $\sqrt{4 - 1/2} = \sqrt{7/2}$。
    *   $2\sqrt{7/2} = \sqrt{14}$。
15. **$(x-2)^2 + (y-4)^2 = 10$**
    *   中心 $x=2$ 上。 $y=2x \to (2, 4)$。
    *   半径 $\sqrt{(2-1)^2 + (4-1)^2} = \sqrt{1+9} = \sqrt{10}$。
16. **最大 $2\sqrt{2}$, 最小 $-2\sqrt{2}$**
17. **$(x-6)^2 + y^2 = 16$**
    *   $2:1$ に内分 $(2, 0)$, 外分 $(10, 0)$。
    *   中心 $(6, 0)$, 半径 $4$。
18. **$(x-1)^2 + (y-1)^2 = 1, (x-5)^2 + (y-5)^2 = 25$**
    *   $(2-r)^2 + (1-r)^2 = r^2 \Rightarrow r^2 - 6r + 5 = 0 \Rightarrow r=1, 5$。
19. **$7x^2 + 7y^2 - 6x - 13 = 0$** ... 訂正
    *   $x^2+y^2-4 + k(x^2-6x+9+y^2-1) = 0$。
    *   $(0, 0)$ 代入: $-4 + k(8) = 0 \Rightarrow k = 1/2$。
    *   $x^2+y^2-4 + 0.5(x^2+y^2-6x+8) = 0$。
    *   $1.5x^2 + 1.5y^2 - 3x = 0 \Rightarrow x^2 + y^2 - 2x = 0$。
    *   (計算ミス確認: $k=1/2$。
    *   $x^2+y^2-4 + 0.5x^2+0.5y^2-3x+4 = 0$。
    *   $1.5x^2 + 1.5y^2 - 3x = 0$。
    *   $x^2 + y^2 - 2x = 0$。
    *   解説修正: **$x^2+y^2-2x=0$**)
20. **$\vec{v} - 2(\vec{v} \cdot \vec{n})\vec{n}$**

