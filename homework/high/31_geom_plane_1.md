# 数学A: 図形の性質 (1) 三角形の五心 (Session 31)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: 三角形の五心（重心、外心、内心、垂心、傍心）の定義と性質を理解し、計算幾何学における座標計算やボロノイ図などのアルゴリズムへの応用を学ぶ。

---

## Phase 1: Foundational Check (基礎確認 10問)

**指針**: 「困ったときは『定義』に還れ」。各心が「何の交点」であり、「何からの距離が等しい」かを整理せよ。

1.  **[重心の定義]** 三角形の重心 (Centroid) は、3本の何を結んだ線の交点か。
    > **Prog Link**: 物理演算における質量中心。メッシュの重心計算。

2.  **[重心の性質]** 重心は中線をどのような比に内分するか。

3.  **[外心の定義]** 三角形の外心 (Circumcenter) は、3辺の何を結んだ線の交点か。
    > **Prog Link**: ボロノイ図 (Voronoi Diagram) の母点。ドロネー三角形分割の外接円中心。

4.  **[外心の性質]** 外心から等距離にある3つの点はどこか。

5.  **[内心の定義]** 三角形の内心 (Incenter) は、3つの何を結んだ線の交点か。
    > **Prog Link**: ポリゴン内への最大円の配置。

6.  **[内心の性質]** 内心から等距離にある3つの線はどれか。

7.  **[垂心の定義]** 三角形の垂心 (Orthocenter) は、3頂点から対辺に下ろした何を結んだ線の交点か。

8.  **[角の二等分線定理]** $\triangle ABC$ において、 $\angle A$ の二等分線と辺 $BC$ の交点を $D$ とするとき、 $BD:DC$ は何に等しいか。

9.  **[中点連結定理]** $\triangle ABC$ の辺 $AB, AC$ の中点をそれぞれ $M, N$ とするとき、 $MN$ と $BC$ の関係を2つ述べよ。

10. **[座標計算]** 3点 $A(x_1, y_1), B(x_2, y_2), C(x_3, y_3)$ を頂点とする三角形の重心 $G$ の座標を求めよ。
    > **Formula**: $( (x_1+x_2+x_3)/3, (y_1+y_2+y_3)/3 )$。

---

## Phase 2: Applied Mastery (応用・実践 10問)

**指針**: 「条件を使い切ったか確認せよ」。角の二等分線定理や中点連結定理を駆使して、長さや比を求めよ。

11. **[重心の利用]**
    $\triangle ABC$ の重心を $G$ とし、 $AG$ の延長と $BC$ の交点を $M$ とする。 $AG=4$ のとき、 $GM$ と $AM$ の長さを求めよ。

12. **[外心の利用]**
    $\angle A = 70^\circ, \angle B = 50^\circ$ である $\triangle ABC$ の外心を $O$ とする。 $\angle BOC$ の大きさを求めよ。
    > **Logic**: 円周角の定理。中心角は円周角の2倍。

13. **[内心の利用]**
    $\triangle ABC$ の内心を $I$ とする。 $\angle A = 80^\circ$ のとき、 $\angle BIC$ の大きさを求めよ。
    > **Formula**: $90^\circ + A/2$。

14. **[角の二等分線]**
    $AB=6, BC=5, CA=4$ である $\triangle ABC$ において、 $\angle A$ の二等分線と $BC$ の交点を $D$ とする。線分 $BD$ の長さを求めよ。

15. **[外心と垂心]**
    鋭角三角形 $ABC$ の外心を $O$、垂心を $H$ とする。 $\angle A = 60^\circ$ のとき、 $\angle BHC$ と $\angle BOC$ の大きさを求めよ。

16. **[重心のベクトル]**
    $\triangle ABC$ の内部に点 $P$ があり、 $\vec{PA} + \vec{PB} + \vec{PC} = \vec{0}$ が成り立つとき、点 $P$ はどのような点か。
    > **Prog Link**: 力の釣り合い。

17. **[オイラー線]**
    正三角形でない三角形において、外心 $O$、重心 $G$、垂心 $H$ は一直線上にある。この直線を何というか。また、 $OG:GH$ の比を求めよ。
    > **Term**: オイラー線 (Euler Line)。 $1:2$。

18. **[傍心]** (発展)
    $\triangle ABC$ の外角の二等分線の交点を傍心という。傍心はいくつあるか。

19. **[内心の座標]** (発展)
    3点 $A, B, C$ の座標と辺の長さ $a, b, c$ が与えられたとき、内心 $I$ の座標をベクトルの加重平均として表せ。
    > **Formula**: $\frac{a\vec{A} + b\vec{B} + c\vec{C}}{a+b+c}$。

20. **[プログラミング]**
    3点 $A, B, C$ の座標が与えられたとき、これらが一直線上にない（三角形を構成する）ことを判定する関数 `is_triangle(a, b, c)` の条件式を記述せよ。
    > **Prog Link**: 外積（クロス積）が0でない、または面積が0でない。 `(b.x - a.x)*(c.y - a.y) - (b.y - a.y)*(c.x - a.x) != 0`。

---

## 解答と解説

### Phase 1

1.  **中線**
2.  **2:1**
3.  **垂直二等分線**
4.  **3つの頂点 (A, B, C)**
5.  **角の二等分線**
6.  **3つの辺 (AB, BC, CA)**
7.  **垂線**
8.  **AB:AC**
9.  **$MN \parallel BC$ かつ $MN = \frac{1}{2}BC$**
10. **$(\frac{x_1+x_2+x_3}{3}, \frac{y_1+y_2+y_3}{3})$**

### Phase 2

11. **GM=2, AM=6**
    *   $AG:GM = 2:1$。 $4:GM = 2:1 \Rightarrow GM=2$。
    *   $AM = 4+2=6$。
12. **$140^\circ$**
    *   $\angle BOC = 2 \angle A = 2 \times 70 = 140^\circ$。
13. **$130^\circ$**
    *   $\angle IBC + \angle ICB = (180 - 80)/2 = 50^\circ$。
    *   $\angle BIC = 180 - 50 = 130^\circ$。
14. **3**
    *   $BD:DC = AB:AC = 6:4 = 3:2$。
    *   $BD = 5 \times \frac{3}{3+2} = 3$。
15. **$\angle BHC = 120^\circ, \angle BOC = 120^\circ$**
    *   $\angle BOC = 2A = 120^\circ$。
    *   四角形 $AFHE$ （$F, E$は垂線の足）は円に内接する（対角和180）。
    *   $\angle FHE = 180 - A = 120^\circ$。 $\angle BHC = \angle FHE$ （対頂角）。
16. **重心**
    *   位置ベクトル $\vec{p} = (\vec{a}+\vec{b}+\vec{c})/3$ となるため。
17. **オイラー線, 1:2**
18. **3つ**
19. **$\frac{a\vec{A} + b\vec{B} + c\vec{C}}{a+b+c}$**
    *   角の二等分線定理を2回適用して導出できる。
20. **解説**
    *   浮動小数点数の誤差（Epsilon）を考慮し、 `abs(cross_product) > EPSILON` とするのが実用的。

