# 数学II: 式と証明 (1) 整式の除法と高次方程式 (Session 35)

**対象**: 社会人エンジニア (Rust/Go)
**学習目標**: 整式の割り算、剰余の定理、因数定理を習得し、高次方程式を解くアルゴリズムを理解する。CRCやハッシュ関数などの工学的応用との関連を知る。

---

## Phase 1: Foundational Check (基礎確認 10問)

**指針**: 「困ったときは『定義』に還れ」。 $A = BQ + R$ （$R$の次数 < $B$の次数）が基本である。

1.  **[整式の割り算]** $x^3 - 2x^2 + 4x - 1$ を $x - 1$ で割った商と余りを求めよ。
    > **Prog Link**: 多項式の除算アルゴリズム。

2.  **[恒等式]** 等式 $x^3 = a(x-1)^3 + b(x-1)^2 + c(x-1) + d$ が $x$ についての恒等式となるように、定数 $a, b, c, d$ を定めよ。
    > **Algorithm**: $x=1$ を代入する、または組立除法を繰り返す（テイラー展開の離散版）。

3.  **[分数式]** $\frac{1}{x(x+1)}$ を部分分数分解せよ。
    > **Prog Link**: 積分計算や逆ラプラス変換の前処理。

4.  **[剰余の定理]** 整式 $P(x)$ を $x - \alpha$ で割った余りは何に等しいか。
    > **Formula**: $P(\alpha)$。

5.  **[因数定理]** 整式 $P(x)$ が $x - \alpha$ を因数に持つための必要十分条件は何か。
    > **Formula**: $P(\alpha) = 0$。

6.  **[計算]** $P(x) = x^3 - 3x^2 + kx + 4$ が $x - 2$ で割り切れるとき、定数 $k$ の値を求めよ。

7.  **[高次方程式]** 方程式 $x^3 - 1 = 0$ を解け。
    > **Tip**: 因数分解 $(x-1)(x^2+x+1)=0$。

8.  **[虚数解]** 方程式 $x^2 + x + 1 = 0$ の解 $\omega$ の性質 $\omega^3 = ?$ を答えよ。

9.  **[組立除法]** $3x^3 - 4x^2 - 2x + 5$ を $x - 2$ で割った商と余りを、組立除法 (Synthetic Division) を用いて求めよ。
    > **Prog Link**: ホーナー法 (Horner's Method) の応用。

10. **[プログラミング]** 多項式 $P(x) = a_n x^n + \dots + a_0$ の値を $x=\alpha$ で評価する際、最も計算量が少ないアルゴリズムは何か。
    > **Algorithm**: ホーナー法。 $O(n)$。

---

## Phase 2: Applied Mastery (応用・実践 10問)

**指針**: 「次数を下げる」ことが基本戦略。高次式を低次式で割った余りに着目せよ。

11. **[余りの決定]**
    整式 $P(x)$ を $x-1$ で割ると 3 余り、 $x+2$ で割ると -3 余る。 $P(x)$ を $(x-1)(x+2)$ で割った余りを求めよ。
    > **Algorithm**: 余りを $ax+b$ と置き、連立方程式を解く。

12. **[高次式の値]**
    $x = 1 + \sqrt{2}$ のとき、 $x^3 - 2x^2 - x + 5$ の値を求めよ。
    > **Logic**: $x-1=\sqrt{2} \to (x-1)^2=2 \to x^2-2x-1=0$ を利用して次数下げ。

13. **[因数分解]**
    $x^4 + 3x^2 + 4$ を因数分解せよ。
    > **Tip**: 複二次式。 $(x^2+2)^2 - x^2$ の形に変形。

14. **[高次方程式]**
    方程式 $x^4 - 3x^3 + 4x^2 - 3x + 1 = 0$ を解け。
    > **Type**: 相反方程式（係数が左右対称）。両辺を $x^2$ で割る。

15. **[3次方程式の解と係数]**
    3次方程式 $x^3 - 2x^2 + 3x - 4 = 0$ の3つの解を $\alpha, \beta, \gamma$ とするとき、 $\alpha^2 + \beta^2 + \gamma^2$ の値を求めよ。
    > **Formula**: $(\alpha+\beta+\gamma)^2 - 2(\alpha\beta+\beta\gamma+\gamma\alpha)$。

16. **[剰余の定理の応用]**
    $x^{100}$ を $x^2 - 1$ で割った余りを求めよ。

17. **[最大公約数]**
    2つの整式 $x^3 - 1$ と $x^3 + x^2 + x + 1$ の最大公約数 (GCD) を求めよ。
    > **Prog Link**: ユークリッドの互除法（多項式版）。

18. **[恒等式の証明]**
    $\frac{a^2}{(a-b)(a-c)} + \frac{b^2}{(b-c)(b-a)} + \frac{c^2}{(c-a)(c-b)} = 1$ を証明せよ。
    > **Logic**: 左辺を通分するか、左辺-1=0 が $a=b, b=c, c=a$ で成り立つことを利用。

19. **[CRCの原理]** (発展)
    データ通信における誤り検出符号 CRC (Cyclic Redundancy Check) は、データを表す多項式 $D(x)$ を生成多項式 $G(x)$ で割った余り $R(x)$ を利用する。
    受信側でデータ $D'(x)$ が正しいかどうかを判定するロジックを整式の演算で説明せよ。
    > **Logic**: $D'(x)$ が $G(x)$ で割り切れるか確認する（実際は $D(x) \cdot x^n + R(x)$ を送る）。

20. **[プログラミング: 多項式乗算]**
    2つの $n$ 次多項式の積を計算する際、単純なアルゴリズムは $O(n^2)$ だが、これを $O(n \log n)$ に高速化するアルゴリズムは何か。
    > **Algorithm**: 高速フーリエ変換 (FFT)。

---

## 解答と解説

### Phase 1

1.  **商 $x^2 - x + 3$, 余り $2$**
    *   組立除法: $1, -2, 4, -1$ を $1$ で。
    *   $1 \to 1, -1 \to -1, 3 \to 3, 2$。
2.  **$a=1, b=3, c=3, d=1$**
    *   $x^3 = ((x-1)+1)^3$。二項定理。
3.  **$\frac{1}{x} - \frac{1}{x+1}$**
4.  **$P(\alpha)$**
5.  **$P(\alpha) = 0$**
6.  **$k = 0$**
    *   $P(2) = 8 - 12 + 2k + 4 = 2k = 0 \Rightarrow k=0$。
7.  **$x = 1, \frac{-1 \pm \sqrt{3}i}{2}$**
8.  **$\omega^3 = 1$**
9.  **商 $3x^2 + 2x + 2$, 余り $9$**
    *   $3, -4, -2, 5$ を $2$ で。
    *   $3 \to 6 \to 2 \to 4 \to 2 \to 4 \to 9$。
10. **ホーナー法**

### Phase 2

11. **$2x+1$**
    *   $R(x) = ax+b$。
    *   $P(1) = a+b = 3$。
    *   $P(-2) = -2a+b = -3$。
    *   引き算: $3a = 6 \Rightarrow a=2$。 $b=1$。
12. **$5$**
    *   $x^2 - 2x - 1 = 0$。
    *   $x^3 - 2x^2 - x + 5 = x(x^2 - 2x - 1) + 5 = x(0) + 5 = 5$。
13. **$(x^2+x+2)(x^2-x+2)$**
    *   $(x^2+2)^2 - x^2 = (x^2+2+x)(x^2+2-x)$。
14. **$x = 1, \frac{1 \pm \sqrt{3}i}{2}$ (重解あり)** ... 訂正
    *   $x^2 - 3x + 4 - 3/x + 1/x^2 = 0$。
    *   $t = x + 1/x$。 $t^2 - 2 - 3t + 4 = 0 \Rightarrow t^2 - 3t + 2 = 0 \Rightarrow (t-1)(t-2)=0$。
    *   $t=1 \Rightarrow x^2 - x + 1 = 0 \Rightarrow x = \frac{1 \pm \sqrt{3}i}{2}$。
    *   $t=2 \Rightarrow x^2 - 2x + 1 = 0 \Rightarrow (x-1)^2 = 0 \Rightarrow x=1$ (重解)。
15. **$-2$**
    *   $\alpha+\beta+\gamma = 2$。 $\alpha\beta+\dots = 3$。
    *   $2^2 - 2(3) = 4 - 6 = -2$。
16. **$1$**
    *   $x^{100} = (x^2-1)Q(x) + ax+b$。
    *   $x=1 \to 1 = a+b$。
    *   $x=-1 \to 1 = -a+b$。
    *   $b=1, a=0$。
17. **$x^2+1$** ... 訂正
    *   $x^3-1 = (x-1)(x^2+x+1)$。
    *   $x^3+x^2+x+1 = x^2(x+1) + (x+1) = (x^2+1)(x+1)$。
    *   共通因数なし？
    *   $x^2+x+1$ と $x^2+1$。差は $x$。互いに素。
    *   答え: 1 (定数)。
    *   (計算ミス確認: $x^3+x^2+x+1$ に $x=1$ 代入 $\to 4$。 $x=\omega$ 代入 $\to 1+\omega^2+\omega+1 = 0+1=1$。
    *   共通根なし。 GCDは1。
    *   解説修正: **1**)
18. **証明**
    *   左辺を $f(a)$ と見る。 $f(b)=1, f(c)=1$。
    *   通分すると分子は2次式。2次式が3点で1を取るなら恒等的に1。
19. **解説**
    *   送信データ $T(x)$ が生成多項式 $G(x)$ で割り切れるように調整されている。受信側で余りが0でなければ誤り。
20. **FFT (高速フーリエ変換)**

